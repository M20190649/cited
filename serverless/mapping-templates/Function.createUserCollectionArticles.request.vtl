#set($userId = $ctx.stash.userId)
#set($collId = $ctx.args.collId)
#set($fullCollId = "user-${userId}-coll-${collId}")
#set($items = [])
#foreach($input in $ctx.args.input)
  #set($item = $util.dynamodb.toMapValues($input))
  $util.qr($item.put("collId", $util.dynamodb.toDynamoDB($fullCollId)))
  #if(!${item.artId})
    $util.qr($item.put("artId", $util.dynamodb.toDynamoDB($util.autoId())))
  #end
  $util.qr($items.add($item))
#end

{
  "version": "2018-05-29",
  "operation": "BatchPutItem",
  "tables": {
    "${tableCollectionArticles}": $util.toJson($items)
  }
}
